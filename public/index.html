<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />

    <title>React App</title>
  </head>

  <body>
    <div style="background: beige; width: 0px; height: 20px"></div>
    <button>按钮</button>
    <div id="root"></div>
    <script type="text/javascript">

      function sleep(duration) {
        let start = Date.now();
        while(start + duration > Date.now()) {

        }
      }
      let works = [
        () => {
          sleep(100)
          console.log("A1开始"), console.log("A1结束");
        },
        () => {
          console.log("B1开始"), console.log("B1结束");
        },
      ];
      requestIdleCallback(workLoop,{timeout:1000});

      function workLoop(deadline) {
        console.log("本帧的的时间", parseInt(deadline.timeRemaining()));
        while (deadline.timeRemaining() > 0 && works.length > 0) {
          perforUnitOfWork();
        }
        if(works.length > 0) {
          requestIdleCallback(workLoop);
        }
      }

      function perforUnitOfWork() {
        let work = works.shift();
        work();
      }
    </script>
  </body>
</html>
